<app-admin-home *ngIf="isAdmin"></app-admin-home>

<ng-container *ngIf="!isAdmin">
  <div class="container mt-4" *ngIf="loading">
    <p>Loading cases...</p>
  </div>
  <div class="container mt-4" *ngIf="error">
    <p class="text-danger">{{ error }}</p>
  </div>

  <div class="container mt-4" *ngIf="!loading && !error">
    <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4">
      <h2 class="mb-0">All Cases</h2>
      <div class="d-flex justify-content-end align-items-center gap-2" *ngIf="cases.length > 1">
        <span class="fw-semibold">Sort:</span>
        <div class="btn-group" role="group" aria-label="Sort cases">
          <button
            type="button"
            class="btn btn-outline-secondary btn-sm"
            [class.active]="sortOrder === 'latest'"
            (click)="setSortOrder('latest')"
          >
            Latest
          </button>
          <button
            type="button"
            class="btn btn-outline-secondary btn-sm"
            [class.active]="sortOrder === 'oldest'"
            (click)="setSortOrder('oldest')"
          >
            Oldest
          </button>
        </div>
      </div>
    </div>
    <ng-container *ngIf="cases.length > 0; else noCases">
      <ng-container *ngFor="let group of groupedCases">
        <h5 class="mb-3 text-secondary month-year-heading">{{ group.label }}</h5>
        <article *ngFor="let caseItem of group.items" class="card mb-3">
          <div class="card-body">
            <h3 class="card-title">
              <a [routerLink]="['/case', caseItem._id]">{{ caseItem.case_title }}</a>
            </h3>
            <p class="card-text mb-1"><b>Handler:</b> {{ caseItem.case_handler }}</p>
            <p class="card-text mb-1">
              <b>Date:</b>
              {{ caseItem.case_date | date: 'dd-MM-yyyy' }}
            </p>
            <p class="card-text mb-1"><b>Status:</b> {{ caseItem.status }}</p>
            <p class="card-text">
              {{ caseItem.case_description?.substring(0, 150) }}...
            </p>
          </div>
        </article>
      </ng-container>
    </ng-container>
    <ng-template #noCases>
      <div class="alert alert-info">No cases found.</div>
    </ng-template>
  </div>
</ng-container>
